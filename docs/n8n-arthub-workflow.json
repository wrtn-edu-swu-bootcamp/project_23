{
  "name": "ì•„íŠ¸í—ˆë¸Œ í†µí•© ì„œë¹„ìŠ¤ (ì´ˆë³´ììš©)",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "arthub",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-1",
      "name": "1ï¸âƒ£ Webhook ì‹œì‘",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1.1,
      "position": [250, 400],
      "notes": "ì—¬ê¸°ì„œ ìš”ì²­ì„ ë°›ìŠµë‹ˆë‹¤!\n\nì˜ˆì‹œ ìš”ì²­:\n{\n  \"category\": \"archive-ongoing\",\n  \"limit\": 10\n}"
    },
    {
      "parameters": {
        "jsCode": "// ğŸ¯ ì¹´í…Œê³ ë¦¬ë³„ URL ë§¤í•‘\nconst ARTHUB_URLS = {\n  // ì•„ì¹´ì´ë¸Œ (ì „ì‹œ)\n  'archive-ongoing': 'https://www.arthub.co.kr/exhibitions',\n  'archive-new': 'https://www.arthub.co.kr/exhibitions?sort=new',\n  'archive-upcoming': 'https://www.arthub.co.kr/exhibitions?status=upcoming',\n  \n  // íë ˆì´ì…˜\n  'curation-column': 'https://www.arthub.co.kr/curation/columns',\n  'curation-news': 'https://www.arthub.co.kr/curation/news',\n  \n  // ê¸°íƒ€\n  'artjob': 'https://www.arthub.co.kr/artjob',\n  'review': 'https://www.arthub.co.kr/review'\n};\n\nconst category = $input.first().json.body.category || 'archive-ongoing';\nconst targetUrl = ARTHUB_URLS[category];\nconst limit = $input.first().json.body.limit || 10;\n\nif (!targetUrl) {\n  throw new Error(`ì•Œ ìˆ˜ ì—†ëŠ” ì¹´í…Œê³ ë¦¬: ${category}`);\n}\n\nconsole.log(`âœ… ì¹´í…Œê³ ë¦¬: ${category}`);\nconsole.log(`ğŸŒ URL: ${targetUrl}`);\n\nreturn {\n  json: {\n    category,\n    targetUrl,\n    limit,\n    originalRequest: $input.first().json.body\n  }\n};"
      },
      "id": "code-1",
      "name": "2ï¸âƒ£ ì¹´í…Œê³ ë¦¬ URL ì„¤ì •",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [400, 400],
      "notes": "ìš”ì²­í•œ ì¹´í…Œê³ ë¦¬ì— ë§ëŠ” URLì„ ì°¾ìŠµë‹ˆë‹¤"
    },
    {
      "parameters": {
        "url": "={{ $json.targetUrl }}",
        "options": {
          "timeout": 30000
        }
      },
      "id": "http-1",
      "name": "3ï¸âƒ£ ì›¹í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [550, 400],
      "notes": "ì•„íŠ¸í—ˆë¸Œ ì›¹ì‚¬ì´íŠ¸ì—ì„œ HTMLì„ ê°€ì ¸ì˜µë‹ˆë‹¤"
    },
    {
      "parameters": {
        "jsCode": "// ğŸ” HTMLì—ì„œ ì½˜í…ì¸  ì¶”ì¶œ (ê°„ë‹¨ ë²„ì „)\nconst html = $input.first().json.data || '';\nconst category = $('2ï¸âƒ£ ì¹´í…Œê³ ë¦¬ URL ì„¤ì •').first().json.category;\nconst limit = $('2ï¸âƒ£ ì¹´í…Œê³ ë¦¬ URL ì„¤ì •').first().json.limit;\n\nconsole.log(`ğŸ“„ HTML ê¸¸ì´: ${html.length}ì`);\n\n// ğŸ¨ ë”ë¯¸ ë°ì´í„° ìƒì„± (ì‹¤ì œ ìŠ¤í¬ë˜í•‘ì€ ì›¹ì‚¬ì´íŠ¸ êµ¬ì¡° ë¶„ì„ í•„ìš”)\nconst categoryNames = {\n  'archive-ongoing': 'ì§„í–‰ì¤‘ì¸ ì „ì‹œ',\n  'archive-new': 'ì‹ ê·œ ì „ì‹œ',\n  'archive-upcoming': 'ì˜ˆì • ì „ì‹œ',\n  'curation-column': 'ì¹¼ëŸ¼',\n  'curation-news': 'ì•„íŠ¸ë‰´ìŠ¤',\n  'artjob': 'ì•„íŠ¸ì¡',\n  'review': 'í‰ë¡ '\n};\n\nconst items = [];\nfor (let i = 0; i < limit; i++) {\n  items.push({\n    id: `arthub-${category}-${Date.now()}-${i}`,\n    title: `[${categoryNames[category]}] ìƒ˜í”Œ ì½˜í…ì¸  ${i + 1}`,\n    summary: `ì´ê²ƒì€ ${categoryNames[category]} ì¹´í…Œê³ ë¦¬ì˜ ìƒ˜í”Œ ì½˜í…ì¸ ì…ë‹ˆë‹¤. ì‹¤ì œ êµ¬í˜„ ì‹œ HTML íŒŒì‹±ìœ¼ë¡œ ì‹¤ì œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.`,\n    url: `https://www.arthub.co.kr/detail/${i}`,\n    thumbnail: `https://via.placeholder.com/300x200?text=Sample+${i+1}`,\n    source: 'arthub',\n    sourceId: 'arthub',\n    category: category,\n    categoryName: categoryNames[category],\n    date: new Date().toISOString(),\n    language: 'ko',\n    \n    // AIê°€ ë¶„ì„í•  ì›ë³¸ ë°ì´í„°\n    rawData: {\n      htmlLength: html.length,\n      extractedAt: new Date().toISOString()\n    }\n  });\n}\n\nconsole.log(`âœ… ${items.length}ê°œ ì•„ì´í…œ ì¶”ì¶œ ì™„ë£Œ`);\n\nreturn items.map(item => ({ json: item }));"
      },
      "id": "code-2",
      "name": "4ï¸âƒ£ ì½˜í…ì¸  ì¶”ì¶œ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [700, 400],
      "notes": "HTMLì—ì„œ ì œëª©, ë§í¬, ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤\n\nâš ï¸ í˜„ì¬ëŠ” ìƒ˜í”Œ ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤\nì‹¤ì œ êµ¬í˜„ ì‹œ HTML íŒŒì‹± ì½”ë“œë¡œ êµì²´í•˜ì„¸ìš”"
    },
    {
      "parameters": {
        "text": "=ë‹¤ìŒ ì•„íŠ¸ ì½˜í…ì¸ ë¥¼ ë¶„ì„í•˜ê³  ê°œì„ í•´ì£¼ì„¸ìš”:\n\nì œëª©: {{ $json.title }}\nìš”ì•½: {{ $json.summary }}\nì¹´í…Œê³ ë¦¬: {{ $json.categoryName }}\n\në‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•´ì£¼ì„¸ìš”:\n1. ì œëª©ì„ ë” ë§¤ë ¥ì ìœ¼ë¡œ ê°œì„ \n2. 3ì¤„ ì´ë‚´ì˜ ê°„ë‹¨í•œ ìš”ì•½ ì‘ì„±\n3. ê´€ë ¨ í‚¤ì›Œë“œ 3ê°œ ì¶”ì¶œ\n4. ì½˜í…ì¸  ìœ í˜• ë¶„ë¥˜ (ì „ì‹œ/ì‘ê°€/ë¦¬ë·°/ë‰´ìŠ¤/ì±„ìš©)\n\në°˜ë“œì‹œ ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µ:\n{\n  \"improvedTitle\": \"ê°œì„ ëœ ì œëª©\",\n  \"summary\": \"3ì¤„ ìš”ì•½\",\n  \"keywords\": [\"í‚¤ì›Œë“œ1\", \"í‚¤ì›Œë“œ2\", \"í‚¤ì›Œë“œ3\"],\n  \"contentType\": \"ì „ì‹œ|ì‘ê°€|ë¦¬ë·°|ë‰´ìŠ¤|ì±„ìš©\"\n}",
        "options": {
          "systemMessage": "=ë‹¹ì‹ ì€ í•œêµ­ ë¯¸ìˆ  ì½˜í…ì¸  ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.\n\nì—­í• :\n- ì•„íŠ¸ ì½˜í…ì¸ ì˜ ì œëª©ê³¼ ë‚´ìš©ì„ ë¶„ì„\n- ë” ë§¤ë ¥ì ì´ê³  SEO ì¹œí™”ì ì¸ ì œëª© ìƒì„±\n- í•µì‹¬ ë‚´ìš©ì„ 3ì¤„ë¡œ ìš”ì•½\n- ê²€ìƒ‰ì— ìœ ìš©í•œ í‚¤ì›Œë“œ ì¶”ì¶œ\n- ì½˜í…ì¸  ìœ í˜• ë¶„ë¥˜\n\nì¶œë ¥:\n- ë°˜ë“œì‹œ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µ\n- í•œêµ­ì–´ ì‚¬ìš©\n- ë‹¤ë¥¸ ì„¤ëª… ì—†ì´ JSONë§Œ ë°˜í™˜"
        }
      },
      "id": "ai-agent-1",
      "name": "5ï¸âƒ£ AI ë¶„ì„ (Gemini)",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [850, 400],
      "notes": "âš™ï¸ ì„¤ì • í•„ìš”:\n1. Chat Model ì¶”ê°€\n2. Google Gemini Chat Model ì„ íƒ\n3. Credential ì—°ê²°\n4. Model: gemini-pro"
    },
    {
      "parameters": {
        "jsCode": "// ğŸ¤– AI ì‘ë‹µ íŒŒì‹±\nconst originalItem = $('4ï¸âƒ£ ì½˜í…ì¸  ì¶”ì¶œ').item.json;\nconst aiResponse = $input.first().json;\n\ntry {\n  // AI ì‘ë‹µì—ì„œ JSON ì¶”ì¶œ\n  let responseText = aiResponse.output || aiResponse.text || '';\n  \n  console.log('ğŸ” AI ì‘ë‹µ:', responseText.substring(0, 200));\n  \n  // JSON ë¶€ë¶„ë§Œ ì¶”ì¶œ\n  const jsonMatch = responseText.match(/\\{[\\s\\S]*\\}/);\n  \n  if (jsonMatch) {\n    const aiResult = JSON.parse(jsonMatch[0]);\n    \n    console.log('âœ… AI íŒŒì‹± ì„±ê³µ');\n    \n    return {\n      json: {\n        ...originalItem,\n        // AIê°€ ê°œì„ í•œ ë‚´ìš©\n        title: aiResult.improvedTitle || originalItem.title,\n        summary: aiResult.summary || originalItem.summary,\n        keywords: aiResult.keywords || [],\n        contentType: aiResult.contentType || 'general',\n        \n        // ì›ë³¸ ë°ì´í„° ë³´ì¡´\n        original: {\n          title: originalItem.title,\n          summary: originalItem.summary\n        },\n        \n        // AI ì²˜ë¦¬ ì™„ë£Œ í‘œì‹œ\n        aiProcessed: true\n      }\n    };\n  } else {\n    console.warn('âš ï¸ JSON ì¶”ì¶œ ì‹¤íŒ¨, ì›ë³¸ ë°˜í™˜');\n    throw new Error('No JSON found');\n  }\n} catch (error) {\n  console.log('âŒ AI íŒŒì‹± ì—ëŸ¬:', error.message);\n  \n  // ì—ëŸ¬ ì‹œ ì›ë³¸ ë°ì´í„° ë°˜í™˜\n  return {\n    json: {\n      ...originalItem,\n      keywords: [],\n      contentType: 'general',\n      aiProcessed: false,\n      error: error.message\n    }\n  };\n}"
      },
      "id": "code-3",
      "name": "6ï¸âƒ£ AI ì‘ë‹µ íŒŒì‹±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1000, 400],
      "notes": "AIì˜ JSON ì‘ë‹µì„ íŒŒì‹±í•˜ì—¬ ë°ì´í„°ì— ì¶”ê°€í•©ë‹ˆë‹¤"
    },
    {
      "parameters": {
        "jsCode": "// ğŸ“¦ ìµœì¢… ì‘ë‹µ í¬ë§·íŒ…\nconst allItems = $input.all().map(item => item.json);\nconst category = $('2ï¸âƒ£ ì¹´í…Œê³ ë¦¬ URL ì„¤ì •').first().json.category;\n\nconst categoryNames = {\n  'archive-ongoing': 'ì§„í–‰ì¤‘ì¸ ì „ì‹œ',\n  'archive-new': 'ì‹ ê·œ ì „ì‹œ',\n  'archive-upcoming': 'ì˜ˆì • ì „ì‹œ',\n  'curation-column': 'ì¹¼ëŸ¼',\n  'curation-news': 'ì•„íŠ¸ë‰´ìŠ¤',\n  'artjob': 'ì•„íŠ¸ì¡',\n  'review': 'í‰ë¡ '\n};\n\nconsole.log(`ğŸ“Š ìµœì¢… ì•„ì´í…œ ìˆ˜: ${allItems.length}`);\n\n// í†µê³„ ê³„ì‚°\nconst aiProcessedCount = allItems.filter(item => item.aiProcessed).length;\nconst contentTypes = {};\nallItems.forEach(item => {\n  const type = item.contentType || 'general';\n  contentTypes[type] = (contentTypes[type] || 0) + 1;\n});\n\nreturn [{\n  json: {\n    success: true,\n    source: 'arthub',\n    sourceId: 'arthub',\n    category: category,\n    categoryName: categoryNames[category],\n    \n    // ğŸ“° ì½˜í…ì¸  ëª©ë¡\n    items: allItems,\n    \n    // ğŸ“Š í†µê³„\n    stats: {\n      total: allItems.length,\n      aiProcessed: aiProcessedCount,\n      contentTypes: contentTypes\n    },\n    \n    // â° ë©”íƒ€ë°ì´í„°\n    metadata: {\n      timestamp: new Date().toISOString(),\n      requestCategory: category,\n      processingTime: Date.now() - $('1ï¸âƒ£ Webhook ì‹œì‘').first().json.$now\n    }\n  }\n}];"
      },
      "id": "code-4",
      "name": "7ï¸âƒ£ ìµœì¢… ì‘ë‹µ í¬ë§·",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1150, 400],
      "notes": "ëª¨ë“  ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ì—¬ ìµœì¢… ì‘ë‹µì„ ë§Œë“­ë‹ˆë‹¤"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseCode": 200
        }
      },
      "id": "respond-1",
      "name": "8ï¸âƒ£ ì‘ë‹µ ë°˜í™˜",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [1300, 400],
      "notes": "í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤"
    }
  ],
  "connections": {
    "1ï¸âƒ£ Webhook ì‹œì‘": {
      "main": [[{"node": "2ï¸âƒ£ ì¹´í…Œê³ ë¦¬ URL ì„¤ì •", "type": "main", "index": 0}]]
    },
    "2ï¸âƒ£ ì¹´í…Œê³ ë¦¬ URL ì„¤ì •": {
      "main": [[{"node": "3ï¸âƒ£ ì›¹í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°", "type": "main", "index": 0}]]
    },
    "3ï¸âƒ£ ì›¹í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°": {
      "main": [[{"node": "4ï¸âƒ£ ì½˜í…ì¸  ì¶”ì¶œ", "type": "main", "index": 0}]]
    },
    "4ï¸âƒ£ ì½˜í…ì¸  ì¶”ì¶œ": {
      "main": [[{"node": "5ï¸âƒ£ AI ë¶„ì„ (Gemini)", "type": "main", "index": 0}]]
    },
    "5ï¸âƒ£ AI ë¶„ì„ (Gemini)": {
      "main": [[{"node": "6ï¸âƒ£ AI ì‘ë‹µ íŒŒì‹±", "type": "main", "index": 0}]]
    },
    "6ï¸âƒ£ AI ì‘ë‹µ íŒŒì‹±": {
      "main": [[{"node": "7ï¸âƒ£ ìµœì¢… ì‘ë‹µ í¬ë§·", "type": "main", "index": 0}]]
    },
    "7ï¸âƒ£ ìµœì¢… ì‘ë‹µ í¬ë§·": {
      "main": [[{"node": "8ï¸âƒ£ ì‘ë‹µ ë°˜í™˜", "type": "main", "index": 0}]]
    }
  },
  "settings": {
    "executionOrder": "v1"
  }
}
